<!DOCTYPE html>
<html>
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

        <link rel="canonical" href="../../../index.html" />
        <meta name="description" content="Create interactive diagrams in JavaScript easily. JointJS plugins for ERD, Org chart, FSA, UML, PN, DEVS, LDM diagrams are ready to use." />
        <meta name="keywords" content="JointJS, JavaScript, diagrams, diagramming library, UML, charts" />

        <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="../../../css/style.css" />

        <link rel="shortcut icon" href="../../../favicon.ico" type="image/x-icon">
        <link rel="icon" href="../../../favicon.ico" type="image/x-icon">

        <title>Rappid toolkit - Documentation</title>
        
    </head>
    <body>
        <header>
    <nav>
        <ul>
            <li><a href="../../../index.html"><img class="logo small" src="../../../images/logo.png" alt="Logo."/>JointJS</a></li>
            <li ><a href="../../../download.html">Download</a></li>
            <li ><a href="../../../demos.html">Demos</a></li>
            <li ><a href="../../../license.html">License</a></li>
            <li ><a href="../../../tutorial.html">Tutorials</a></li>
            <li ><a href="../../../api.html">JointJS API</a></li>
            <li class="active"><a href="../../docs.html">Rappid API</a></li>
            <li ><a href="../../../support.html">Support</a></li>
            <li ><a href="../../../about-rappid.html">Rappid</a></li>
        </ul>
    </nav>
</header>


        <section id="rappid-docs">
            <div class="content-sidebar">
  <input id="api-search" type="search" placeholder="e.g. chart"/>
    <ul class="searchable">
        <li><a href="../../docs.html">Home</a></li>
        <li><a href="../ui/stencil.html">ui.Stencil</a>
            <ul>
                <li><a href="../ui/stencil.html#installation">Installation</a>
                <li><a href="../ui/stencil.html#loading">Loading with elements</a>
                <li><a href="../ui/stencil.html#groups">Groups (Accordion)</a>
                <li><a href="../ui/stencil.html#searchable">Searchable stencil</a>
                <li><a href="../ui/stencil.html#methods">Other methods</a>
                <li><a href="../ui/stencil.html#added-elements">React on added elements</a>
            </ul>
        </li>
        <li><a href="../ui/halo.html">ui.Halo</a>
            <ul>
                <li><a href="../ui/halo.html#installation">Installation</a>
                <li><a href="../ui/halo.html#create">Creating a Halo</a>
                <li><a href="../ui/halo.html#configuration">Configuration</a>
                <li><a href="../ui/halo.html#magnets">Halo &amp; magnets</a>
                <li><a href="../ui/halo.html#disable-tools">Disabling Halo tools</a>
                <li><a href="../ui/halo.html#customize">Customizing Halo tools</a>
                <li><a href="../ui/halo.html#halo-api">Halo API</a>
                <li><a href="../ui/halo.html#halo-events">Halo Events</a>
            </ul>
        </li>
        <li><a href="../ui/freeTransform.html">ui.FreeTransform</a>
            <ul>
                <li><a href="../ui/freeTransform.html#installation">Installation</a>
                <li><a href="../ui/freeTransform.html#create">Creating a FreeTransform</a>
            </ul>
        </li>
        <li><a href="../ui/inspector.html">ui.Inspector</a>
            <ul>
                <li><a href="../ui/inspector.html#installation">Installation</a>
                <li><a href="../ui/inspector.html#create">Creating an Inspector</a>
                <li><a href="../ui/inspector.html#configuration">Configuration</a>
                <li><a href="../ui/inspector.html#expressions">Expressions</a>
                <li><a href="../ui/inspector.html#inspector-remember-groups-state">Remember groups state</a>
                <li><a href="../ui/inspector.html#inspector-events">Inspector Events</a>
                <li><a href="../ui/inspector.html#inspector-methods">Inspector Methods</a>
            </ul>
        </li>
        <li><a href="../ui/paperScroller.html">ui.PaperScroller</a>
            <ul>
                <li><a href="../ui/paperScroller.html#installation">Installation</a>
                <li><a href="../ui/paperScroller.html#center">Centering the paper content</a>
                <li><a href="../ui/paperScroller.html#zoom">Zooming the paper</a>
                <li><a href="../ui/paperScroller.html#auto-resize">Paper auto-resize/shrink</a>
            </ul>
        </li>
        <li><a href="../ui/selectionView.html">ui.SelectionView</a>
            <ul>
                <li><a href="../ui/selectionView.html#installation">Installation</a>
                <li><a href="../ui/selectionView.html#create">Initializing SelectionView</a>
                <li><a href="../ui/selectionView.html#changes">Reacting on changes</a>
                <li><a href="../ui/selectionView.html#customization">Custmozing the look of SelectionView</a>
                <li><a href="../ui/selectionView.html#disable-tools">Disabling Tools</a>
                <li><a href="../ui/selectionView.html#customize-tools">Customizing tools</a>
                <li><a href="../ui/selectionView.html#selection-api">SelectionView API</a>
                <li><a href="../ui/selectionView.html#selection-events">SelectionView events</a>
                <li><a href="../ui/selectionView.html#common-setup">Common Setup</a>
            </ul>
        </li>
        <li><a href="../ui/clipboard.html">ui.Clipboard</a>
            <ul>
                <li><a href="../ui/clipboard.html#installation">Installation</a>
                <li><a href="../ui/clipboard.html#create">Creating a Clipboard</a>
            </ul>
        </li>
        <li><a href="../ui/tooltip.html">ui.Tooltip</a>
            <ul>
                <li><a href="../ui/tooltip.html#installation">Installation</a>
                <li><a href="../ui/tooltip.html#create">Creating a Tooltip</a>
            </ul>
        </li>
        <li><a href="../ui/snaplines.html">ui.Snaplines</a>
            <ul>
                <li><a href="../ui/snaplines.html#installation">Installation</a>
                <li><a href="../ui/snaplines.html#enable">Enabling Snaplines</a>
            </ul>
        </li>
        <li><a href="commandManager.html">dia.CommandManager</a>
            <ul>
                <li><a href="commandManager.html#installation">Installation</a>
                <li><a href="commandManager.html#create">Creating a CommandManager</a>
                <li><a href="commandManager.html#howitworks">How CommandManager works</a>
                <li><a href="commandManager.html#methods">CommandManager API</a>
            </ul>
        </li>
        <li><a href="validator.html">dia.Validator</a>
            <ul>
                <li><a href="validator.html#installation">Installation</a>
                <li><a href="validator.html#create">Creating a Validator</a>
                <li><a href="validator.html#methods">Validator API</a>
            </ul>
        </li>
        <li><a href="graphUtils.html">dia.GraphUtils</a>
            <ul>
                <li><a href="graphUtils.html#installation">Installation</a>
                <li><a href="graphUtils.html#methods">Methods</a>
            </ul>
        </li>
        <li><a href="../com/channel.html">com.Channel</a>
            <ul>
                <li><a href="../com/channel.html#installation">Installation</a>
                <li><a href="../com/channel.html#use">Usage</a>
                <li><a href="../com/channel.html#rooms">Rooms</a>
                <li><a href="../com/channel.html#configuration">Configuration</a>
            </ul>
        </li>
        <li><a href="../shapes/bpmn.html">shapes.BPMN</a>
            <ul>
                <li><a href="../shapes/bpmn.html#installation">Installation</a>
                <li><a href="../shapes/bpmn.html#activity">Activity</a>
                <li><a href="../shapes/bpmn.html#annotation">Annotation</a>
                <li><a href="../shapes/bpmn.html#choreography">Choreography</a>
                <li><a href="../shapes/bpmn.html#conversation">Conversation</a>
                <li><a href="../shapes/bpmn.html#data-object">Data Object</a>
                <li><a href="../shapes/bpmn.html#event">Event</a>
                <li><a href="../shapes/bpmn.html#flow">Flow</a>
                <li><a href="../shapes/bpmn.html#gateway">Gateway</a>
                <li><a href="../shapes/bpmn.html#group">Group</a>
                <li><a href="../shapes/bpmn.html#message">Message</a>
                <li><a href="../shapes/bpmn.html#pool">Pool</a>
                <li><a href="../shapes/bpmn.html#icons">Icons</a>
                <li><a href="../shapes/bpmn.html#sub-process">Sub-process handling</a>
            </ul>
        </li>
        <li><a href="../shapes/chart.html">shapes.Chart</a>
            <ul>
                <li><a href="../shapes/chart.html#installation">Installation</a>
                <li><a href="../shapes/chart.html#types">Chart Types</a>
            </ul>
        </li>
        <li><a href="../shapes/chart/plot.html">shapes.chart.Plot</a>
            <ul>
              <li><a href="../shapes/chart/plot.html#create">Basic Chart</a>
              <li><a href="../shapes/chart/plot.html#series-style">Series Styling</a>
              <li><a href="../shapes/chart/plot.html#multiple-series">Multiple Series</a>
              <li><a href="../shapes/chart/plot.html#markings">Markings</a>
              <li><a href="../shapes/chart/plot.html#guidelines">Guidelines</a>
              <li><a href="../shapes/chart/plot.html#tooltips">Tooltips</a>
              <li><a href="../shapes/chart/plot.html#legend">Legend</a>
              <li><a href="../shapes/chart/plot.html#rt">Real-time Data</a>
              <li><a href="../shapes/chart/plot.html#fixed-axis">Fixed Axis</a>
              <li><a href="../shapes/chart/plot.html#time-series">Time Series</a>
              <li><a href="../shapes/chart/plot.html#bar-series">Bar Series</a>
              <li><a href="../shapes/chart/plot.html#bar-line-series">Bar &amp; Line Series</a>
              <li><a href="../shapes/chart/plot.html#chart-options">Chart Options</a>
              <li><a href="../shapes/chart/plot.html#chart-api">Chart API</a>
              <li><a href="../shapes/chart/plot.html#chart-structure">Chart SVG Structure</a>
	    </ul>
	</li>
        <li><a href="../shapes/chart/pie.html">shapes.chart.Pie</a>
            <ul>
              <li><a href="../shapes/chart/pie.html#create">Basic Chart</a>
              <li><a href="../shapes/chart/pie.html#slices-style">Styling Slices</a>
              <li><a href="../shapes/chart/pie.html#multiple-series">Multiple Series</a>
              <li><a href="../shapes/chart/pie.html#exploding">Exploding Slices</a>
              <li><a href="../shapes/chart/pie.html#donut">Donut Chart</a>
              <li><a href="../shapes/chart/pie.html#tooltips">Tooltips</a>
              <li><a href="../shapes/chart/pie.html#legend">Legend</a>
              <li><a href="../shapes/chart/pie.html#animation">Animation</a>
              <li><a href="../shapes/chart/pie.html#effects">Effects</a>
              <li><a href="../shapes/chart/pie.html#chart-options">Chart Options</a>
              <li><a href="../shapes/chart/pie.html#chart-api">Chart API</a>
              <li><a href="../shapes/chart/pie.html#chart-structure">Chart SVG Structure</a>
	    </ul>
	</li>
        <li><a href="../shapes/chart/knob.html">shapes.chart.Knob</a>
            <ul>
              <li><a href="../shapes/chart/knob.html#create">Basic Knob</a>
              <li><a href="../shapes/chart/knob.html#knob-style">Styling the Knob</a>
              <li><a href="../shapes/chart/knob.html#multiple-series">Multiple Values</a>
              <li><a href="../shapes/chart/knob.html#tooltips">Tooltips</a>
              <li><a href="../shapes/chart/knob.html#animation">Animation</a>
              <li><a href="../shapes/chart/knob.html#knob-options">Knob Options</a>
              <li><a href="../shapes/chart/knob.html#knob-api">Knob API</a>
              <li><a href="../shapes/chart/knob.html#knob-structure">Knob SVG Structure</a>
	    </ul>
	</li>
        <li><a href="../format/svg.html">format.SVG</a>
            <ul>
                <li><a href="../format/svg.html#installation">Installation</a>
                <li><a href="../format/svg.html#use">Usage</a>
                <li><a href="../format/svg.html#configuration">Configuration</a>
            </ul>
        </li>
        <li><a href="../format/raster.html">format.Raster</a>
            <ul>
                <li><a href="../format/raster.html#installation">Installation</a>
                <li><a href="../format/raster.html#use">Usage</a>
            </ul>
        </li>
        <li><a href="../format/gexf.html">format.GEXF</a>
            <ul>
                <li><a href="../format/gexf.html#installation">Installation</a>
                <li><a href="../format/gexf.html#use">Usage</a>
            </ul>
        </li>
        <li><a href="../format/print.html">format.Print</a>
            <ul>
                <li><a href="../format/print.html#installation">Installation</a>
                <li><a href="../format/print.html#use">Usage</a>
                <li><a href="../format/print.html#logo">Custom logo</a>
            </ul>
        </li>
        <li><a href="../layout/directedGraph.html">layout.DirectedGraph</a>
            <ul>
                <li><a href="../layout/directedGraph.html#installation">Installation</a>
                <li><a href="../layout/directedGraph.html#use">Usage</a>
            </ul>
        </li>
        <li><a href="../layout/gridLayout.html">layout.GridLayout</a>
            <ul>
                <li><a href="../layout/gridLayout.html#installation">Installation</a>
                <li><a href="../layout/gridLayout.html#use">Usage</a>
            </ul>
        </li>
        <li><a href="../layout/forceDirected.html">layout.ForceDirected</a>
            <ul>
                <li><a href="../layout/forceDirected.html#installation">Installation</a>
                <li><a href="../layout/forceDirected.html#use">Usage</a>
            </ul>
        </li>
    </ul>
</div>

            
            <link rel="stylesheet" href="../../../css/joint.all.min.css" />
            <script src="../../../js/joint.all.min.js"></script>

            <div class="content-container">
                <h2><img src="../../../images/plugins/validator.png"/>dia.Validator</h2>

<p>Validator runs a set of callbacks to determine if a command is valid. This is useful
for checking if a certain action in your application does lead to an invalid state of the diagram 
(from your application specific perspective). You can not only cancel such command but
e.g. also give the user a hint that this action is not allowed).</p>

<h2 id="intallation">Installation</h2>

<p>Include <code>joint.dia.command.js</code> and <code>joint.dia.validator.js</code> to your HTML:</p>
<pre><code>
&lt;script src="joint.dia.command.js" type="text/javascript" &gt;&lt;/script&gt;
&lt;script src="joint.dia.vaidator.js" type="text/javascript" &gt;&lt;/script&gt;
</code></pre>


<h2 id="create">Creating Validator</h2>

<pre><code>
var graph = new joint.dia.Graph;
var paper = new joint.dia.Paper({ el: $('#paper'), width: 500, height: 500, model: graph });

var commandManager = new joint.dia.CommandManager({ graph: graph });
<strong>var validator = new joint.dia.Validator({ graph: graph });</strong>
validator.validate('remove', 
    function(err, command, next) {
        if (command.data.type === 'basic.Rect') return next('Rectangles cannot be removed.');
        return next();
    }, 
    function(err, command, next) {
        if (err) console.log(err);
        return next(err);
    }
);

</code></pre>

<p>(Those that know the great <a href="http://expressjs.com">ExpressJS</a> application framework might have
recognized a similar API to what ExpressJS provides for registering URL route handlers.)</p>

<div class="docs-demo">
    <label>Validations in the following demo: dropping a cell over another not allowed, connecting rectangle with circle not allowed,
        connecting text to anything not allowed (the other way around is allowed), dropping a link in a blank area not allowed,
        only one link coming from rectangle is allowed, .... (see the source code of the demo).</label>
    <div id="paper-holder-create" class="paper"></div>
    <div class="code-link">
        <a target="_blank" href="../../../js/docs/validator-create.js">source code to this demo</a>
    </div>
</div>
<script src="../../../js/docs/validator-create.js"></script>

<h2 id="methods">Validator API</h2> 

<h3>constructor</h3>

<p>The <code>joint.dia.Validator</code> constructor takes two parameters.</p> 

<h4>commandManager</h4>
<p>The CommandManager the validator listens to.</p>

<h4>cancelInvalid</h4>
<p>Determine whether to cancel an invalid command or not. If set to <code>false</code>, only the <code>invalid</code> event is triggered.</p>
<p>Default is <code>true</code>.</p>

<h3>validate</h3>

<p>Function <code>validate(action [, callback]*)</code> registers callbacks for a given action.</p>

<p> The validator listens on commands added to the CommandManager and runs this set of callbacks registered for the <code>action</code>.
If the last callback returns an error the command is canceled (see <code>joint.dia.CommandManager.cancel()</code>). 
This behaviour can be supressed by setting the <code>cancelInvalid</code> to <code>false</code> in options passed to the Validator constructor.</p>

<h4>action</h4>
Action is the name of the event triggered on the graph (see <a href="../../../api.html#joint.dia.Graph:events">List of triggered events</a>). 
Multiple actions may be given seperated by whitespaces.

<pre><code>
validate("change:source change:target", function() { .. });
</pre></code>

<h4>callback</h4>
<pre><code>callback(err, command, next)</code></pre>

<p>The validation function. An arbitrary number of validation functions can be passed to <code>validate()</code>. Every callback has the following signature:</p>

<p>Where <code>err</code> is an error from the previous callback.</p>
<p>The <code>command</code> parameter is a record from the CommandManager stack. It holds information about an action in the graph.</p>
<p>See below for the structure of a <code>command</code>. This command says that a <code>basic.Rect</code> element has been moved by 50px down.</p>
<pre><code>
{
  "action" : "change:position"
  "data": {
    "id":"e0552cf2-fb05-4444-a9eb-3636a4589d64", // id of the cell it was manipulated with
    "type":"basic.Rect", // type of the cell

    // change:attribute events have always these two attributes filled
    "previous": { "position":{"x":50,"y":50} },
    "next": { "position": {"x":50,"y":100}},
  },
  "batch":true, // is command part of a batch command?
  "options":{} // Backbone options that are passed through the listeners when passed as the last argument to the Backbone Model set() method.
}
</code></pre>

<p>The <code>add</code> and <code>remove</code> actions have <code>previous</code> and <code>next</code> object empty. They hold all the 
cell attributes in the <code>attributes</code> object so that the CommandManager is able to reconstruct the whole cell if it has to. 
See below for an example of such a command structure:</p>

<pre><code>
{
  "action": "add",
  "data" : {
    "id" : "28de715b-62a7-4130-a729-1bcf7dbb1f2b",
    "type":"basic.Circle",

    //empty attributes
    "previous":{},
    "next":{},

    // all cells attributes
    "attributes": {
      "type":"basic.Circle",
      "size": {
        "width":50,
       "height":30
      },
     "position":{"x":1220,"y":680},
     "id":"28de715b-62a7-4130-a729-1bcf7dbb1f2b",
     "attrs" : {
       "circle" : {
         "width":50,
         "height":30
       }
     }
  "batch":true,
  "options" : {
    "add":true,
    "merge":false,
    "remove":false
  }
}
</code></pre>

<p>The <code>next</code> parameter is a function accepting one argument - an error passed to the next callback in a row.</p>
Calling <code>next()</code> function means going to the next callback in the order passed to the <code>validate()</code> method. 
If a call to the <code>next()</code> function is omitted, the validation for the specified action stops.</p>



                <br/>
                <br/>
                <br/>
                <hr/>
                Copyright &copy; 2009 - 2014 <strong>client IO</strong> (<a href="http://client.io">http://client.io</a>, <a href="mailto:org@client.io">org@client.io</a>)
            </div>
        </section>

        <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-5029684-2']);
    _gaq.push(['_setAllowLinker', true]);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>


        <link rel="stylesheet" href="../../../vendor/prism/prism.css">
        <script src="../../../vendor/prism/prism.js"></script>

        <script src="../../../js/client-search.js"></script>
        <script src="../../../js/rappid-docs.js"></script>
    </body>
</html>
